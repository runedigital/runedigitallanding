<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PAWN PASS // ULTRA</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Syncopate:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.29.0/feather.min.js"></script>
    <style>
        :root {
            --bg: #050505;
            --card: #111;
            --accent: #00ff9d;
            --text: #fff;
            --dim: #666;
            --border: #222;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; user-select: none; }

        body {
            background: var(--bg);
            color: var(--text);
            overflow: hidden; /* Lock scroll for app feel */
            height: 100vh;
            display: flex; flex-direction: column;
        }

        /* --- NAV --- */
        nav {
            padding: 1.5rem;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border);
            background: rgba(5,5,5,0.9); backdrop-filter: blur(10px);
            z-index: 10;
        }
        .logo { font-weight: 800; font-size: 1.2rem; color: var(--accent); display: flex; align-items: center; gap: 0.5rem; }

        /* --- APP CONTAINER --- */
        .app-view {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            padding: 2rem;
            display: flex; flex-direction: column;
            background: var(--bg);
            transition: transform 0.4s cubic-bezier(0.4, 0.0, 0.2, 1), opacity 0.4s;
            opacity: 0; pointer-events: none; transform: translateY(20px);
        }

        .screen.active { opacity: 1; pointer-events: auto; transform: translateY(0); z-index: 2; }
        .screen.prev { transform: translateY(-20px); opacity: 0; }

        /* --- TYPOGRAPHY --- */
        h1 { font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem; line-height: 1; }
        h2 { font-size: 1.5rem; margin-bottom: 1rem; }
        .sub { color: var(--dim); margin-bottom: 2rem; font-size: 0.9rem; }

        /* --- FORMS --- */
        select, input {
            width: 100%; background: #111; border: 1px solid var(--border);
            color: #fff; padding: 1.2rem; border-radius: 12px; font-size: 1rem;
            margin-bottom: 1rem; outline: none;
        }
        select:focus { border-color: var(--accent); }

        .btn-main {
            width: 100%; padding: 1.2rem; background: var(--accent);
            color: #000; font-weight: 800; border: none; border-radius: 12px;
            font-size: 1rem; cursor: pointer; margin-top: auto;
            display: flex; align-items: center; justify-content: center; gap: 0.5rem;
        }
        .btn-main:active { transform: scale(0.98); }

        /* --- QUOTE SCREEN --- */
        .quote-box {
            background: rgba(0,255,157,0.05); border: 1px solid var(--accent);
            padding: 2rem; border-radius: 16px; text-align: center; margin-bottom: 2rem;
        }
        .price-tag { font-size: 3.5rem; font-weight: 800; color: var(--accent); text-shadow: 0 0 20px rgba(0,255,157,0.3); }

        /* --- SCANNER (THE MAGIC) --- */
        #scanner-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; opacity: 0.5;
        }
        
        .scan-ui {
            flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative; z-index: 10;
        }

        .fingerprint-zone {
            width: 120px; height: 120px;
            border: 2px dashed #333; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 2rem; position: relative;
            transition: all 0.3s;
        }

        .fingerprint-zone.scanning { border-color: var(--accent); border-style: solid; box-shadow: 0 0 30px var(--accent); }

        .scan-icon { width: 60px; height: 60px; color: #333; transition: 0.3s; }
        .fingerprint-zone.scanning .scan-icon { color: var(--accent); opacity: 1; }

        .progress-bar {
            width: 200px; height: 4px; background: #222; border-radius: 2px; overflow: hidden;
        }
        .fill { width: 0%; height: 100%; background: var(--accent); }

        /* --- SUCCESS OVERLAY --- */
        .success-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 100; display: none;
            flex-direction: column; align-items: center; justify-content: center;
        }
        .check-anim { width: 100px; height: 100px; color: var(--accent); animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn { 0% { transform: scale(0); } 100% { transform: scale(1); } }

    </style>
    <!-- THREE.JS -->
    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
    </script>
</head>
<body>

    <nav>
        <div class="logo"><i data-feather="hexagon"></i> PAWN PASS</div>
        <div style="font-size: 0.7rem; color: var(--dim);">BETA v0.9</div>
    </nav>

    <div class="app-view">
        
        <!-- SCREEN 1: SELECTION -->
        <div class="screen active" id="screen1">
            <h1>Get Cash.</h1>
            <p class="sub">Instant valuation. No human interaction.</p>
            
            <label style="color:#888; font-size:0.8rem; margin-bottom:0.5rem; display:block;">ASSET TYPE</label>
            <select id="itemSelect">
                <option value="385">Sony PlayStation 5</option>
                <option value="850">MacBook Pro M1</option>
                <option value="8400">Rolex Submariner</option>
                <option value="620">iPhone 14 Pro</option>
            </select>
            
            <label style="color:#888; font-size:0.8rem; margin-bottom:0.5rem; display:block;">CONDITION</label>
            <select>
                <option>Pristine (Like New)</option>
                <option>Good (Minor Wear)</option>
                <option>Fair</option>
            </select>

            <div style="margin-top: 1rem; padding: 1rem; background: #111; border-radius: 8px; font-size: 0.8rem; color: #666;">
                <i data-feather="lock" style="width:12px; display:inline"></i> 256-Bit Encrypted Valuation
            </div>

            <button class="btn-main" onclick="toScreen2()">GET OFFER</button>
        </div>

        <!-- SCREEN 2: VALUATION -->
        <div class="screen" id="screen2">
            <div style="text-align: center; margin-bottom: 2rem;">
                <p class="sub">INSTANT OFFER</p>
                <div class="quote-box">
                    <div class="price-tag" id="priceDisplay">$0.00</div>
                    <div style="color: var(--dim); font-size: 0.8rem; margin-top: 0.5rem;">Available via OSKO Immediately</div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem;">
                <div style="background: #111; padding: 1rem; border-radius: 8px; text-align: center;">
                    <div style="color: #666; font-size: 0.7rem;">INTEREST</div>
                    <div style="font-weight: bold;">5.0% / mo</div>
                </div>
                <div style="background: #111; padding: 1rem; border-radius: 8px; text-align: center;">
                    <div style="color: #666; font-size: 0.7rem;">TERM</div>
                    <div style="font-weight: bold;">30 Days</div>
                </div>
            </div>

            <button class="btn-main" onclick="toScreen3()">ACCEPT & SIGN</button>
            <button style="background: transparent; border: none; color: #666; width: 100%; padding: 1rem; margin-top: 0.5rem;" onclick="reset()">Decline</button>
        </div>

        <!-- SCREEN 3: BIOMETRIC SIGNATURE -->
        <div class="screen" id="screen3">
            <h2 style="text-align: center; font-family: 'Syncopate'; letter-spacing: 2px; font-size: 1rem;">IDENTITY VERIFICATION</h2>
            <p style="text-align: center; color: #666; font-size: 0.8rem; margin-bottom: 2rem;">Hold thumb to sign contract</p>

            <!-- SCANNER UI -->
            <div class="scan-ui">
                <div class="fingerprint-zone" id="scanZone">
                    <i data-feather="fingerprint" class="scan-icon"></i>
                </div>
                <div class="progress-bar"><div class="fill" id="scanFill"></div></div>
                <div id="scanText" style="margin-top: 1rem; font-size: 0.8rem; color: #444; letter-spacing: 2px;">WAITING FOR BIOMETRICS</div>
            </div>

            <!-- PARTICLE CANVAS (Behind UI) -->
            <div id="canvas-container"></div>
        </div>

    </div>

    <!-- SUCCESS OVERLAY -->
    <div class="success-overlay" id="successScreen">
        <i data-feather="check-circle" class="check-anim" style="width: 80px; height: 80px;"></i>
        <h1 style="margin-top: 2rem;">FUNDS SENT</h1>
        <p style="color: #666;">Uber Courier Dispatched.</p>
        <div style="margin-top: 2rem; padding: 1rem; border: 1px solid #333; color: #333; border-radius: 8px;">REF: #9942-X</div>
    </div>

    <script type="module">
        import * as THREE from 'three';
        feather.replace();

        // --- NAVIGATION LOGIC ---
        window.toScreen2 = () => {
            const val = document.getElementById('itemSelect').value;
            document.getElementById('priceDisplay').innerText = '$' + val;
            switchScreen('screen1', 'screen2');
        };

        window.toScreen3 = () => {
            switchScreen('screen2', 'screen3');
            initThreeJS(); // Start particles only when needed
        };

        window.reset = () => {
            location.reload();
        };

        function switchScreen(from, to) {
            document.getElementById(from).classList.add('prev');
            document.getElementById(from).classList.remove('active');
            document.getElementById(to).classList.add('active');
        }

        // --- THREE.JS PARTICLES (ONYX ENGINE) ---
        let renderer, scene, camera, particles;
        let isScanning = false;
        let scanProgress = 0;

        function initThreeJS() {
            const container = document.getElementById('canvas-container');
            if(renderer) return; // Already init

            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, container.offsetWidth / container.offsetHeight, 0.1, 1000);
            camera.position.z = 30;

            renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(container.offsetWidth, container.offsetHeight);
            container.appendChild(renderer.domElement);

            // Create Particles
            const geometry = new THREE.BufferGeometry();
            const count = 2000;
            const pos = new Float32Array(count * 3);
            for(let i=0; i<count*3; i++) pos[i] = (Math.random() - 0.5) * 60;
            geometry.setAttribute('position', new THREE.BufferAttribute(pos, 3));

            const material = new THREE.PointsMaterial({
                size: 0.15, color: 0x00ff9d, transparent: true, opacity: 0.4
            });

            particles = new THREE.Points(geometry, material);
            scene.add(particles);

            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            
            // Idle Rotation
            particles.rotation.y += 0.002;
            
            // Scan Effect
            if(isScanning) {
                particles.rotation.z += 0.05; // Spin fast
                particles.material.opacity = 0.8;
                particles.material.color.setHex(0x00ff9d);
                camera.position.z = Math.max(10, camera.position.z - 0.2); // Zoom in
            } else {
                particles.rotation.z += 0.001;
                particles.material.opacity = 0.2;
                particles.material.color.setHex(0x444444);
                camera.position.z = Math.min(30, camera.position.z + 0.5); // Zoom out
            }

            renderer.render(scene, camera);
        }

        // --- SCANNER LOGIC ---
        const zone = document.getElementById('scanZone');
        const fill = document.getElementById('scanFill');
        const text = document.getElementById('scanText');

        // Mouse/Touch Events
        const startScan = (e) => {
            e.preventDefault();
            isScanning = true;
            zone.classList.add('scanning');
            text.innerText = "VERIFYING IDENTITY...";
            text.style.color = "#00ff9d";
        };

        const endScan = (e) => {
            isScanning = false;
            zone.classList.remove('scanning');
            text.innerText = "WAITING FOR BIOMETRICS";
            text.style.color = "#444";
            scanProgress = 0;
            fill.style.width = '0%';
        };

        zone.addEventListener('mousedown', startScan);
        zone.addEventListener('touchstart', startScan);
        zone.addEventListener('mouseup', endScan);
        zone.addEventListener('touchend', endScan);
        zone.addEventListener('mouseleave', endScan);

        // Game Loop
        setInterval(() => {
            if(isScanning) {
                scanProgress += 2;
                fill.style.width = scanProgress + '%';
                
                if(scanProgress >= 100) {
                    isScanning = false;
                    document.getElementById('successScreen').style.display = 'flex';
                }
            }
        }, 20);

        // Handle Resize
        window.addEventListener('resize', () => {
            if(renderer) {
                const container = document.getElementById('canvas-container');
                camera.aspect = container.offsetWidth / container.offsetHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.offsetWidth, container.offsetHeight);
            }
        });

    </script>
</body>
</html>